<?php
/*
                       :....................,:,              
                    ,.`,,,::;;;;;;;;;;;;;;;;:;`              
                  `...`,::;:::::;;;;;;;;;;;;;::'             
                 ,..``,,,::::::::::::::::;:;;:::;            
                :.,,``..::;;,,,,,,,,,,,,,:;;;;;::;`          
               ,.,,,`...,:.:,,,,,,,,,,,,,:;:;;;;:;;          
              `..,,``...;;,;::::::::::::::'';';';:''         
              ,,,,,``..:;,;;:::::::::::::;';;';';;'';        
             ,,,,,``....;,,:::::::;;;;;;;;':'''';''+;        
             :,::```....,,,:;;;;;;;;;;;;;;;''''';';';;       
            `,,::``.....,,,;;;;;;;;;;;;;;;;'''''';';;;'      
            :;:::``......,;;;;;;;;:::::;;;;'''''';;;;:       
            ;;;::,`.....,::;;::::::;;;;;;;;'''''';;,;;,      
            ;:;;:;`....,:::::::::::::::::;;;;'''':;,;;;      
            ';;;;;.,,,,::::::::::::::::::;;;;;''':::;;'      
            ;';;;;.;,,,,::::::::::::::::;;;;;;;''::;;;'      
            ;'';;:;..,,,;;;:;;:::;;;;;;;;;;;;;;;':::;;'      
            ;'';;;;;.,,;:;;;;;;;;;;;;;;;;;;;;;;;;;:;':;      
            ;''';;:;;.;;;;;;;;;;;;;;;;;;;;;;;;;;;''';:.      
            :';';;;;;;::,,,,,,,,,,,,,,:;;;;;;;;;;'''';       
             '';;;;:;;;.,,,,,,,,,,,,,,,,:;;;;;;;;'''''       
             '''';;;;;:..,,,,,,,,,,,,,,,,,;;;;;;;''':,       
             .'''';;;;....,,,,,,,,,,,,,,,,,,,:;;;''''        
              ''''';;;;....,,,,,,,,,,,,,,,,,,;;;''';.        
               '''';;;::.......,,,,,,,,,,,,,:;;;''''         
               `''';;;;:,......,,,,,,,,,,,,,;;;;;''          
                .'';;;;;:.....,,,,,,,,,,,,,,:;;;;'           
                 `;;;;;:,....,,,,,,,,,,,,,,,:;;''            
                   ;';;,,..,.,,,,,,,,,,,,,,,;;',             
                     '';:,,,,,,,,,,,,,,,::;;;:               
                      `:;'''''''''''''''';:.                 
                                                             
     ,,,::::::::::::::::::::::::;;;;,::::::::::::::::::::::::
     ,::::::::::::::::::::::::::;;;;,::::::::::::::::::::::::
     ,:; ## ## ##  #####     ####      ## ## ##  ##   ##  ;::
     ,,; ## ## ##  ## ##    ##         ## ## ##  ##   ##  ;::
     ,,; ## ## ##  ##  ##  ##   ####   ## ## ##   ## ##   ;::
     ,,' ## ## ##  ## ##    ##    ##   ## ## ##   ## ##   :::
     ,:: ########  ####      ######    ########    ###    :::
     ,,,:,,:,,:::,,,:;:::::::::::::::;;;:::;:;:::::::::::::::
     ,,,,,,,,,,,,,,,,,,,,,,,,:,::::::;;;;:::::;;;;::::;;;;:::
                                                             
    	     (c) WDGWV. 2013, http://www.wdgwv.nl            
    	 websites, Apps, Hosting, Services, Development.      

	PHP Ajax IRC Chat (PAIC)
	Version:   0.0.0.1 Alpha
	Website:   http://www.wdgwv.com
	Revision:  100
	Last Edit: 27-NOV-2013 21:00 By WdG
	Authors:   WdG, Wesley de Groot, wes@wdgwv.com, http://www.wdgwv.com
		       Your initials, Your name, your mail, your website
*/

	#Session ID Exists? (SID)
	if ( isset ( $_GET['sid'] ) )
	{
			 #LOAD THE MAIN FILE.
			 include "irc.php";

			 	# IS THERE A NICKNAME???
				if ( isset ( $_POST['nick'] ) )
					{
						#REMOVE OLD NICK, AND WRITE DOWN NEW NICK IN "data/XXX.XXX.XXX.XXX.nick"
						unlink("data/" . $_SERVER['REMOTE_ADDR'] . ".nick");
						$F = fopen("data/" . $_SERVER['REMOTE_ADDR'] . ".nick",'a');
						fwrite($F, $_POST['nick']);
						fclose($F);
 					}

			 #LOAD THE CLASS
			 $irc = new WdgssAjaxIrc ( ) ;

			 #GET ENCODED IP
		$x = $irc -> EncodeIp    ( $_SERVER['REMOTE_ADDR'] ) ;

			#RUN THE "SERVER" FOR AJAX.
		echo $irc -> RunServer   ( $_SERVER['REMOTE_ADDR'] ) ;
	}
	else
	{
		#ERROR: NO SESSION ID EXISTS.
		echo "ERROR [No Server]";
	}

?>